# 变更日志：实现 SSR + 缓存策略

**日期:** 2025年8月31日

## 概述

本次更新对项目的核心渲染架构进行了重大重构，从原有的静态站点生成 (SSG) 模式切换为按需服务器端渲染 (SSR) 并结合 Cloudflare Cache API进行缓存的策略。

## 变更详情

### 1. 废除 SSG 构建步骤

-   **移除了 `build.ts`**: 该文件原先负责在部署前预先构建所有页面的 HTML。此文件已被完全删除。
-   **更新了 `package.json`**: 删除了原有的 `"build"` 脚本，因为它不再需要。

### 2. 实现动态渲染与缓存

-   **引入了 Hono 中间件**: 在 `src/index.ts` 的核心应用中，我们添加了一个新的中间件来处理所有传入的页面请求。
-   **缓存优先策略**:
    -   当用户请求一个页面时，中间件会首先检查 Cloudflare 的 **Cache API** 中是否存在该页面的有效缓存。
    -   如果存在（**缓存命中**），则直接从缓存中返回 HTML，实现极速响应。
    -   如果不存在（**缓存未命中**），请求将继续由 Hono 的路由处理器进行处理，动态生成页面内容。
-   **自动缓存填充**:
    -   动态生成的页面在返回给用户的同时，会被异步地存入 Cache API。
    -   这确保了该页面的下一次访问将是缓存命中，从而提高了后续访问的性能。

## 动机

-   **提高灵活性**: 无需在每次内容更新后都执行手动构建和部署步骤。内容更改（例如，更新 `raw/*.json` 文件）可以即时反映在下一次缓存未命中时。
-   **简化工作流**: 消除了对 `build` 脚本的依赖，使开发和部署流程更加简洁。
-   **兼顾性能**: 通过利用 Cloudflare 的边缘缓存，我们仍然可以为绝大多数用户提供接近静态文件的访问速度，同时保留了动态渲染的能力。

## 结论

此次架构升级使网站更加现代化和高效，实现了按需生成和智能缓存的完美结合，为未来的功能迭代和内容管理奠定了坚实的基础。
